{{- if .Values.openshift.enabled -}}
# âœ… RESSOURCE SPÃ‰CIFIQUE OPENSHIFT : La Route
# Contrairement Ã  l'Ingress standard, la Route est native Ã  OpenShift 
# et gÃ¨re automatiquement l'exposition publique et le DNS.
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  # Utilisation du helper Helm pour gÃ©nÃ©rer un nom unique basÃ© sur la release
  name: {{ include "petite-maison-troc.fullname" . }}-frontend
  labels:
    # Injection des labels standards (app, version, etc.) pour la traÃ§abilitÃ©
    {{- include "petite-maison-troc.labels" . | nindent 4 }}
spec:
  # ğŸ”— LIAISON : On pointe la Route vers le Service Frontend
  to:
    kind: Service
    name: {{ include "petite-maison-troc.fullname" . }}-frontend
  
  # ğŸšª PORT : On cible le port nommÃ© 'http' dÃ©fini dans le Service
  port:
    targetPort: http

  # ğŸ” SÃ‰CURITÃ‰ (HTTPS) : Configuration de la terminaison TLS
  tls:
    # Mode 'edge' : Le certificat SSL est portÃ© par le routeur OpenShift.
    # Le trafic est chiffrÃ© sur le web, puis dÃ©chiffrÃ© Ã  l'entrÃ©e du cluster.
    termination: edge
    
    # Redirection automatique : Si l'utilisateur arrive en HTTP, 
    # OpenShift le renvoie vers la version sÃ©curisÃ©e HTTPS.
    insecureEdgeTerminationPolicy: Redirect
{{- end -}}