# ✅ GESTION DES SECRETS (ISO 27001)
# Ce fichier centralise toutes les données sensibles. Elles sont injectées
# dynamiquement dans les Pods sous forme de variables d'environnement.
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
  labels:
    {{- include "petite-maison-troc.labels" . | nindent 4 }}
type: Opaque
data:
  # --- BASE DE DONNÉES ---
  # L'encodage b64enc est une exigence de Kubernetes pour les objets Secret.
  postgres-db: {{ .Values.secrets.dbName | b64enc | quote }}
  postgres-user: {{ .Values.secrets.dbUser | b64enc | quote }}
  postgres-password: {{ .Values.secrets.dbPassword | b64enc | quote }}

  # --- SÉCURITÉ JWT ---
  # Utilisés par le Backend pour signer et vérifier les jetons d'authentification.
  jwt-secret: {{ .Values.secrets.jwtSecret | b64enc | quote }}
  jwt-refresh-secret: {{ .Values.secrets.jwtRefreshSecret | b64enc | quote }}