apiVersion: v1
kind: Secret
metadata:
  # Nom du secret bas√© sur la release Helm
  name: {{ .Release.Name }}-secrets

  # Labels standards Helm/Kubernetes
  labels:
    app.kubernetes.io/name: petite-maison
    app.kubernetes.io/instance: {{ .Release.Name }}
    managed-by: helm

type: Opaque

data:
  # --- üóÑÔ∏è BASE DE DONN√âES SUPABASE ---
  # Les valeurs proviennent de values-secrets.yaml
  # Elles sont encod√©es en base64 comme l'exige Kubernetes
  dbHost: {{ .Values.secrets.dbHost | toString | b64enc | quote }}
  dbPort: {{ .Values.secrets.dbPort | toString | b64enc | quote }}
  dbName: {{ .Values.secrets.dbName | toString | b64enc | quote }}
  dbUser: {{ .Values.secrets.dbUser | toString | b64enc | quote }}
  dbPassword: {{ .Values.secrets.dbPassword | toString | b64enc | quote }}
  dbUrl: {{ .Values.secrets.dbUrl | toString | b64enc | quote }}

  # --- üîê CL√âS JWT ---
  # Utilis√©es par le backend pour signer les tokens
  jwtSecret: {{ .Values.secrets.jwtSecret | toString | b64enc | quote }}
  jwtRefreshSecret: {{ .Values.secrets.jwtRefreshSecret | toString | b64enc | quote }}

# --- üîê SDK SUPABASE (Nouveau : pour le stockage Stateless) ---
  # Ces cl√©s permettent au SDK d'envoyer les images vers le Cloud
  supabaseUrl: {{ .Values.secrets.supabaseUrl | toString | b64enc | quote }}
  supabaseKey: {{ .Values.secrets.supabaseKey | toString | b64enc | quote }}