# ‚úÖ D√âPLOIEMENT DU FRONTEND
# G√®re le cycle de vie des Pods (r√©plication, mise √† jour, image Docker)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Release.Name }}-frontend
  labels:
    app: frontend
spec:
  # Nombre d'instances souhait√©es (d√©fini dans values.yaml)
  replicas: {{ .Values.frontend.replicaCount | default 1 }}
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
        - name: web
          # Image r√©cup√©r√©e depuis la GitHub Container Registry (GHCR)
          # Correction : Utilisation du repository et du tag pour former une URL valide
          image: "{{ .Values.frontend.image.repository }}:{{ .Values.frontend.image.tag }}"
          imagePullPolicy: {{ .Values.frontend.pullPolicy | default "Always" }}
          ports:
            - containerPort: {{ .Values.frontend.containerPort | default 80 }}
          env:
            # üåê INJECTION DE L'URL API : Permet au Front de savoir o√π appeler le Back.
            # Sur OpenShift, cette URL sera l'adresse de la Route Backend.
            - name: REACT_APP_API_URL
              value: {{ .Values.backend.url | quote }}