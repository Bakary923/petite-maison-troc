# ============================================================
# VALUES.YAML - PETITE MAISON DU TROC (MODE HYBRIDE)
# ============================================================

# --- 1. CONFIGURATION DE LA PLATEFORME ---
openshift:
  enabled: true # Active la création des Routes OpenShift

# --- 2. SECRETS & SÉCURITÉ (Placeholders) ---
# Les vraies valeurs sont injectées via values-secrets.yaml
secrets:
  dbHost: "REDACTED"
  dbPort: "6543"
  dbUrl: "REDACTED" # Ajouté pour supporter la chaîne de connexion complète
  dbName: "REDACTED"
  dbUser: "REDACTED"
  dbPassword: "REDACTED"
  jwtSecret: "REDACTED"
  jwtRefreshSecret: "REDACTED"

# --- 3. BACKEND (API) ---
backend:
  image:
    repository: ghcr.io/bakary923/petite-maison-troc/backend
    tag: latest
    pullPolicy: Always

  replicaCount: 1
  containerPort: 3000
  servicePort: 3000
  serviceType: ClusterIP

  # URL interne pour la communication entre pods
  url: "http://petite-maison-backend:3000/api"

# --- 4. FRONTEND (WEB) ---
frontend:
  image:
    repository: ghcr.io/bakary923/petite-maison-troc/frontend
    tag: latest
    pullPolicy: Always

  replicaCount: 1
  # Changé de 80 à 8080 pour correspondre au Dockerfile et Nginx.conf
  containerPort: 8080
  servicePort: 8080
  serviceType: ClusterIP

  # URL publique (Route OpenShift)
  url: "http://petite-maison.local"

# --- 5. BASE DE DONNÉES (SUPABASE MODE POOLER) ---
# On utilise le Transaction Pooler pour la compatibilité IPv4/OpenShift
database:
  host: "aws-1-eu-west-1.pooler.supabase.com" 
  port: 6543 # Port spécifique au mode Transaction Pooler
  name: "postgres"

# --- 6. STOCKAGE PERSISTANT (UPLOADS) ---
storage:
  pvcName: "uploads-pvc"
  uploadsSize: 1Gi
  accessMode: ReadWriteOnce

# --- 7. INGRESS (Désactivé sur OpenShift) ---
ingress:
  enabled: false
  className: "nginx"
  host: "petite-maison.local"