# ============================================================
# VALUES.YAML - CONFIGURATION REVERSE PROXY
# ============================================================

openshift:
  enabled: true 

secrets:
  # Valeurs injectées par GitHub Secrets (la CD)
  dbHost: "REDACTED"
  dbPort: "5432"
  dbUrl: "REDACTED"
  dbName: "REDACTED"
  dbUser: "REDACTED"
  dbPassword: "REDACTED"
  jwtSecret: "REDACTED"
  jwtRefreshSecret: "REDACTED"

# --- 3. BACKEND (API) ---
backend:
  image:
    repository: ghcr.io/bakary923/petite-maison-troc/backend
    tag: latest
    pullPolicy: Always
  replicaCount: 1
  containerPort: 3000
  servicePort: 3000
  serviceType: ClusterIP
  # IMPORTANT : Le frontend contactera le backend via ce chemin relatif grâce au proxy Nginx
  url: "/api"
  # --- AJOUT POUR LA MONTÉE EN CHARGE ---
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "256Mi"
  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 70

# --- 4. FRONTEND (WEB) ---
frontend:
  image:
    repository: ghcr.io/bakary923/petite-maison-troc/frontend
    tag: latest
    pullPolicy: Always
  replicaCount: 1
  containerPort: 8080
  servicePort: 8080
  serviceType: ClusterIP
  # METS ICI TA VRAIE ROUTE (récupérée avec oc get routes)
  url: "https://petite-maison-frontend-bakary-badiaga-dev.apps.rm3.7wse.p1.openshiftapps.com"
  # --- AJOUT POUR LE FRONTEND (STABILITÉ) ---
  resources:
    requests:
      cpu: "50m"
      memory: "64Mi"
    limits:
      cpu: "100m"
      memory: "128Mi"

# --- 5. BASE DE DONNÉES ---
database:
  host: "aws-1-eu-west-1.pooler.supabase.com" 
  port: 5432 
  name: "postgres"

# --- 6. STOCKAGE ---
storage:
  pvcName: "uploads-pvc"
  uploadsSize: 1Gi
  accessMode: ReadWriteOnce

# --- 7. INGRESS ---
ingress:
  enabled: false # On utilise les Routes OpenShift